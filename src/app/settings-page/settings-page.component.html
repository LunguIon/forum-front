<div class="main-container font-julius-sans-one fw-normal container-fluid fill d-flex">
    <div class="m-1 m-lg-5 flex-grow-1 d-flex justify-content-between flex-column">
        
        <div class="fs-2 py-lg-2 py-1 px-1 px-sm-4">Settings</div>

        <div class="mx-1 my-lg-3 my-0">
            <hr class="divider" />
        </div>

        <div class="flex-grow-1 d-flex justify-content-between flex-column gap-1 py-lg-4 py-5">

            <div class="row d-flex justify-content-between align-items-center">
                <div class="col d-flex justify-content-between align-items-lg-center flex-lg-row flex-column" style="flex-grow: 3;">
                    <div class="flex-grow-1 d-flex justify-content-start align-items-center">
                        <span class="w30h30 d-flex align-content-center mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
                            </svg>                              
                        </span>
                        <span class="fs-4 fw-bold lh-base">
                            Username
                        </span>
                    </div>
                    <div class="flex-grow-1 d-flex justify-content-lg-end align-items-end ms-2 ms-lg-0">
                        <span class="fs-4 lh-base font-inter property">
                            {{user.username}}
                        </span>
                    </div>
                </div> 
                <div class="col d-flex justify-content-center align-items-center" style="flex-grow: 1;">
                    <div class="my-btn px-1 px-lg-4 py-1" id="discard-topic" (click)="openUsernameModal();">
                        <div class="px-3 px-md-4 fs-4">Change</div>
                    </div>
                </div>
            </div>

            <div class="row d-flex justify-content-between align-items-center">
                <div class="col d-flex justify-content-between align-items-lg-center flex-lg-row flex-column" style="flex-grow: 3;">
                    <div class="flex-grow-1 d-flex justify-content-start align-items-center">
                        <span class="w30h30 d-flex align-content-center mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                            </svg>
                        </span>
                        <span class="fs-4 fw-bold lh-base">
                            Email
                        </span>
                    </div>
                    <div class="flex-grow-1 d-flex justify-content-lg-end align-items-end ms-2 ms-lg-0">
                        <span class="fs-4 lh-base font-inter property">
                            {{user.email}}
                        </span>
                    </div>
                </div> 
                <div class="col d-flex justify-content-center align-items-center" style="flex-grow: 1;">
                    <div class="my-btn px-1 px-lg-4 py-1" id="discard-topic" (click)="openEmailModal();">
                        <div class="px-3 px-md-4 fs-4">Change</div>
                    </div>
                </div>
            </div>

            <div class="row d-flex justify-content-between align-items-center">
                <div class="col d-flex justify-content-between align-items-lg-center flex-lg-row flex-column" style="flex-grow: 3;">
                    <div class="flex-grow-1 d-flex justify-content-start align-items-center">
                        <span class="w30h30 d-flex align-content-center mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z" />
                            </svg>
                        </span>
                        <span class="fs-4 fw-bold lh-base">
                            Password
                        </span>
                    </div>
                    <div class="flex-grow-1 d-flex justify-content-lg-end align-items-end ms-2 ms-lg-0">
                        <span class="fs-4 lh-base font-inter property">
                            &nbsp;
                        </span>
                    </div>
                </div> 
                <div class="col d-flex justify-content-center align-items-center" style="flex-grow: 1;">
                    <div class="my-btn px-1 px-lg-4 py-1" id="discard-topic" (click)="openPasswordModal();">
                        <div class="px-3 px-md-4 fs-4">Change</div>
                    </div>
                </div>
            </div>

            <!-- <div class="row d-flex justify-content-between align-items-center">
                <div class="col d-flex justify-content-between align-items-lg-center flex-lg-row flex-column" style="flex-grow: 3;">
                    <div class="flex-grow-1 d-flex justify-content-start align-items-center">
                        <span class="w30h30 d-flex align-content-center mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M15 9h3.75M15 12h3.75M15 15h3.75M4.5 19.5h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Zm6-10.125a1.875 1.875 0 1 1-3.75 0 1.875 1.875 0 0 1 3.75 0Zm1.294 6.336a6.721 6.721 0 0 1-3.17.789 6.721 6.721 0 0 1-3.168-.789 3.376 3.376 0 0 1 6.338 0Z" />
                            </svg>                              
                        </span>
                        <span class="fs-4 fw-bold lh-base">
                            Avatar
                        </span>
                    </div>
                    <div class="flex-grow-1 d-flex justify-content-lg-end align-items-end ms-2 ms-lg-0">
                        <span class="fs-4 lh-base font-inter property">
                            &nbsp;
                        </span>
                    </div>
                </div> 
                <div class="col d-flex justify-content-center align-items-center" style="flex-grow: 1;">
                    <div class="my-btn px-1 px-lg-4 py-1" id="discard-topic">
                        <div class="px-3 px-md-4 fs-4">Change</div>
                    </div>
                </div>
            </div> -->
    
            
        </div>

        <div class="mx-1 my-3">
            <hr class="divider" />
        </div>
        
        <div class="row d-flex justify-content-between align-items-center py-lg-4 py-2 mb-4">
            <div class="col d-flex justify-content-between align-items-center " style="flex-grow: 3;">
                <div class="flex-grow-1 d-flex justify-content-start align-items-center">
                    <span class="fs-3 lh-base px-5">
                        Delete
                    </span>
                </div>
                <div class="flex-grow-1 d-flex justify-content-start align-items-center">
                    <span class="fs-4 lh-base property">
                        &nbsp;
                    </span>
                </div>
            </div> 
            <div class="col d-flex justify-content-center align-items-center" style="flex-grow: 1;">
                
                <div class="my-btn px-1 px-lg-4 py-1 d-flex align-items-center justify-content-center" (click)="openDeleteModal()" id="delete-account-btn">
                    <div class="px-3 px-md-4 fs-4">Delete</div>
                    <span class="w30h30 d-flex justify-content-center align-itemes-center mx-1">
                        <span class="w30h30 d-flex align-content-center mx-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9.75 14.25 12m0 0 2.25 2.25M14.25 12l2.25-2.25M14.25 12 12 14.25m-2.58 4.92-6.374-6.375a1.125 1.125 0 0 1 0-1.59L9.42 4.83c.21-.211.497-.33.795-.33H19.5a2.25 2.25 0 0 1 2.25 2.25v10.5a2.25 2.25 0 0 1-2.25 2.25h-9.284c-.298 0-.585-.119-.795-.33Z" />
                            </svg>                                                            
                        </span>                          
                    </span>
                </div>
                
            </div>
        </div>
</div>

<ng-template #usernameModal let-modal>
    <div class="modal-content py-4 px-sm-5 px-3">
        <div class="modal-header d-flex justify-content-center align-items-lg-center">
            <div class="fs-1 font-julius-sans-one">
                Change Username
            </div>
        </div>
        <div class="modal-body p-2">
            <form #changeUsernameForm="ngForm" (ngSubmit)="changeUsername(changeUsernameForm)" class="d-flex justify-content-center gap-3 flex-column">
                <input type="text" class="font-inter rounded-5 form-control flex-grow-1 px-4 py-1 py-md-2 fs-4" placeholder="New Username" name="new-username" required ngModel #newUsername="ngModel">
                
                <div class="mt-4  mb-md-3 px-md-5 d-flex flex-column gap-md-3 gap-1">
                    <div class="font-julius-sans-one link-light text-decoration-none text-capitalize text-center fs-6 err-message" style="max-height: 1.3rem;" *ngIf="(newUsername.invalid && newUsername.touched); else usernameDummyElement">
                        <div *ngIf="newUsername.errors?.['required']">New Username is required.</div>
                    </div>
                </div>

                <ng-template #usernameDummyElement>
                    <div class="font-julius-sans-one link-light text-decoration-none text-capitalize text-center fs-6 err-message invisible" style="max-height: 1.3rem;">dummyElement</div>
                </ng-template>

                <div class="flex-grow-1 d-flex justify-content-center  gap-3 flex-row font-julius-sans-one">
                    <div class="col  my-btn px-1 px-lg-4 py-1" (click)="toggleSubmitBtnAnimation(changeUsernameForm)"  (@bouceOnClick.done)="onSubmitBtnAnimationDone()" [@bouceOnClick]="submitBtnState" id="save-new-username">
                        <input type="submit" value="Save" class="font-julius-sans-one my-btn-secondary px-3 px-md-4 fs-4 submit">
                    </div>
                    <div class="col  my-btn-secondary px-1 px-lg-4 py-1" (click)="closeUsernameModal()" id="discard-username-modal">
                        <div class="px-3 px-md-4 fs-4">Discard</div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
        </div>
    </div>
</ng-template>

<ng-template #emailModal let-modal>
    <div class="modal-content py-4 px-sm-5 px-3">
        <div class="modal-header d-flex justify-content-center align-items-lg-center">
            <div class="fs-1 font-julius-sans-one">
                Change Email
            </div>
        </div>
        <div class="modal-body p-2">
            <form #changeEmailForm="ngForm" (ngSubmit)="changeEmail(changeEmailForm)" class="d-flex justify-content-center gap-3 flex-column">
                <input type="email" class="font-inter rounded-5 form-control flex-grow-1 px-4 py-1 py-md-2 fs-4" placeholder="New Email" name="new-email" email required ngModel #newEmail="ngModel">
                
                <div class="mt-4  mb-md-3 px-md-5 d-flex flex-column gap-md-3 gap-1">
                    <div class="font-julius-sans-one link-light text-decoration-none text-capitalize text-center fs-6 err-message" style="max-height: 1.3rem;" *ngIf="(newEmail.invalid && newEmail.touched); else emailDummyElement">
                        <div *ngIf="newEmail.errors?.['required']">New Email is required.</div>
                        <div *ngIf="newEmail.errors?.['email']">Invalid email format.</div>
                    </div>
                </div>

                <ng-template #emailDummyElement>
                    <div class="font-julius-sans-one link-light text-decoration-none text-capitalize text-center fs-6 err-message invisible" style="max-height: 1.3rem;">dummyElement</div>
                </ng-template>

                <div class="flex-grow-1 d-flex justify-content-center  gap-3 flex-row font-julius-sans-one">
                    <div class="col  my-btn px-1 px-lg-4 py-1" (click)="toggleSubmitBtnAnimation(changeEmailForm)"  (@bouceOnClick.done)="onSubmitBtnAnimationDone()" [@bouceOnClick]="submitBtnState" id="save-new-username">
                        <input type="submit" value="Save" class="font-julius-sans-one my-btn-secondary px-3 px-md-4 fs-4 submit">
                    </div>
                    <div class="col  my-btn-secondary px-1 px-lg-4 py-1" (click)="closeEmailModal()" id="discard-email-modal">
                        <div class="px-3 px-md-4 fs-4">Discard</div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
        </div>
    </div>
</ng-template>

<ng-template #passwordModal let-modal>
    <div class="modal-content py-4 px-sm-5 px-3">
        <div class="modal-header d-flex justify-content-center align-items-lg-center">
            <div class="fs-1 font-julius-sans-one">
                Change Password
            </div>
        </div>
        <div class="modal-body p-2">
            <form #changePasswdForm="ngForm" (ngSubmit)="changePassword(changePasswdForm)" class="d-flex justify-content-center flex-column gap-3">
                <div class="d-flex justify-content-center align-items-center position-relative">
                    <input [type]="isSignupPasswordVisible ? 'text' : 'password'" class="form-control flex-grow-1 py-1 py-md-2 px-md-3 fs-5 passwd-input" placeholder="New Password" name="password" required ngModel #signupPassword="ngModel" id="new-signup-password">
                    <span class="passwd-btn btn p-1" id="signup-show-password-btn" (click)="isSignupPasswordVisible = !isSignupPasswordVisible">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w25h25" *ngIf="isSignupPasswordVisible">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w25h25" *ngIf="!isSignupPasswordVisible">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                        </svg>
                    </span>
                </div>

                <div class="d-flex justify-content-center align-items-center position-relative">
                    <input [type]="isSignupConfirmPasswordVisible ? 'text' : 'password'" class="form-control flex-grow-1 py-1 py-md-2 px-md-3 fs-5 passwd-input" placeholder="Confirm New Password" name="confirm-password" required ngModel #signupConfirmPassword="ngModel" id="confirm-new-password">
                    <span class="passwd-btn btn p-1" id="signup-show-confirm-password-btn" (click)="isSignupConfirmPasswordVisible = !isSignupConfirmPasswordVisible">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w25h25" *ngIf="isSignupConfirmPasswordVisible">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w25h25" *ngIf="!isSignupConfirmPasswordVisible">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                        </svg>  
                    </span>
                </div>

                <div class="d-flex justify-content-center align-items-center position-relative mt-5">
                    <input [type]="isNewPasswordVisible ? 'text' : 'password'" class="form-control flex-grow-1 py-1 py-md-2 px-md-3 fs-5 passwd-input" placeholder="Old Password" name="old-password" required ngModel #oldPassword="ngModel" id="old-password">
                    <span class="passwd-btn btn p-1" id="signup-show-confirm-password-btn" (click)="isNewPasswordVisible = !isNewPasswordVisible">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w25h25" *ngIf="isSignupConfirmPasswordVisible">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z" />
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w25h25" *ngIf="!isSignupConfirmPasswordVisible">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88" />
                        </svg>  
                    </span>
                </div>

                <div class="mt-4  mb-md-3 px-md-5 d-flex flex-column gap-md-3 gap-1">
                    <div class="font-julius-sans-one link-light text-decoration-none text-capitalize text-center fs-6 err-message" style="max-height: 1.3rem;" *ngIf="(oldPassword.invalid && oldPassword.touched) || (signupPassword.invalid && signupPassword.touched) || (signupConfirmPassword.invalid && signupConfirmPassword.touched) || (signupPassword.value !== signupConfirmPassword.value); else sigupDummyElement">
                        <div *ngIf="oldPassword.errors?.['required']">Old Password is required.</div>
                        <div *ngIf="signupPassword.errors?.['required']">New Password is required.</div>
                        <div *ngIf="signupConfirmPassword.errors?.['required']">Confirm New Password is required.</div>
                        <div *ngIf="signupPassword.value !== signupConfirmPassword.value">Passwords dont match.</div>
                    </div>
                </div>

                <ng-template #sigupDummyElement>
                    <div class="font-julius-sans-one link-light text-decoration-none text-capitalize text-center fs-6 err-message invisible" style="max-height: 1.3rem;">dummyElement</div>
                </ng-template>

                <div class="flex-grow-1 d-flex justify-content-center  gap-3 flex-row font-julius-sans-one">
                    <div class="col  my-btn px-1 px-lg-4 py-1" (click)="toggleChangePasswdBtnAnimation(changePasswdForm)"  (@bouceOnClick.done)="onSubmitBtnAnimationDone()" [@bouceOnClick]="submitBtnState" id="save-new-passwd">
                        <input type="submit" value="Save" class="font-julius-sans-one my-btn-secondary px-3 px-md-4 fs-4 submit">
                    </div>
                    <div class="col  my-btn-secondary px-1 px-lg-4 py-1" (click)="closePasswordModal();"  id="discard-passwd-modal">
                        <div class="px-3 px-md-4 fs-4">Discard</div>
                    </div>
                </div>
            </form>
        </div>
        <div class="modal-footer">
        </div>
    </div>
</ng-template>

<ng-template #deleteModal let-modal>
    <div class="modal-content py-4 px-sm-5 px-3">
        <div class="modal-header d-flex justify-content-center align-items-lg-center">
            <div class="fs-2 text-center font-julius-sans-one">
                Are you sure you want to delete your accout?
            </div>
        </div>
        <div class="modal-body p-2">
            <div class="flex-grow-1 d-flex justify-content-center  gap-3 flex-row font-julius-sans-one">
                <div class="col  my-btn px-1 px-lg-4 py-1" (click)="deleteAccout()" id="discard-email-modal">
                    <div class="px-3 px-md-4 fs-4">Yes</div>
                </div>
                <div class="col  my-btn-secondary px-1 px-lg-4 py-1" (click)="closeDeleteModal()" id="discard-email-modal">
                    <div class="px-3 px-md-4 fs-4">No</div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
        </div>
    </div>
</ng-template>

<ng-template #usernameChangedToast>Username changed!</ng-template>
<ng-template #emailChangedToast>Email changed!</ng-template>
<ng-template #passwordChangedToast>Password changed!</ng-template>
<ng-template #accountDeletedToast>Account Deleted!</ng-template>
<ng-template #smtWrongToast>Something Wrong!</ng-template>
<app-toasts-container aria-live="polite" aria-atomic="true"></app-toasts-container>